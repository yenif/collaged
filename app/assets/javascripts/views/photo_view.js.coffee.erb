class window.PhotoView extends Backbone.View
  tagName: "div"
  className: "photo"
  events: {
  }

  initialize: ->
    @model.bind('change', this.render, this)
    @model.view = this

  dim: (w,h) =>
    if h/w > @model.image_height()/@model.image_width()
      @image_height = h + 'px'
      @image_width = 'auto'
    else
      @image_height = 'auto'
      @image_width = w + 'px'

    @width = w
    @height = h

    $(this.el).css {
      width: @width, height: @height,
      overflow: 'hidden', margin: '3px',
      position: 'absolute'
    }
    return this

  pos: (x,y) =>
    $(this.el).css({left: x, top: y})
    return this

  render: (options)=>
    if 'x' of options && 'y' of options
      @pos(options.x, options.y)
    if 'w' of options && 'h' of options
      @dim(options.w,options.h)

    $(this.el).html(_.template(<%= Templater.render_template :photo_show %>,{
      image_url: @model.get('image_url'),
      image_width: @image_width,
      image_height: @image_height
    }))

    return this
